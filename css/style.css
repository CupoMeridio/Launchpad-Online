/*
  Questo file contiene gli stili CSS generali per l'applicazione Launchpad.
  Definisce l'aspetto di base della pagina, il layout, la sidebar, i menu
  e altri elementi dell'interfaccia utente. Modificando questo file, è possibile
  personalizzare l'aspetto e la sensazione generale dell'applicazione.
*/

/*
  STILI DI BASE
  - Impostano le proprietà fondamentali per l'intera pagina.
  - PERSONALIZZAZIONE: Puoi cambiare il `font-family` per usare un font diverso,
    o modificare `background-color` e `color` per cambiare il tema di colori (es. tema chiaro).
*/
html, body {
    height: 100%; /* Assicura che l'HTML e il body occupino sempre il 100% dell'altezza dello schermo. */
}

.midi-status-dot.connected {
  background-color: #4CAF50; /* Green */
}

.midi-status-dot.disconnected {
  background-color: #f44336; /* Red */
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; /* Utilizza un set di font di sistema moderni e puliti. */
    background-color: #1a1a1a; /* Colore di sfondo principale, un grigio molto scuro. */
    color: #f0f0f0; /* Colore del testo principale, un grigio molto chiaro per contrasto. */
    margin: 0; /* Rimuove i margini predefiniti del browser per un controllo completo sul layout. */
    overflow: hidden; /* Impedisce lo scrolling a livello del body, utile per layout a schermo intero. */
}

/*
  STILI PER I TITOLI
  - PERSONALIZZAZIONE: Cambia il colore `#00aaff` per modificare il colore principale dei titoli.
*/
h1, h2 {
    color: #00aaff; /* Un blu acceso per dare risalto ai titoli. */
    margin: 0; /* Rimuove i margini per un allineamento preciso. */
}

/*
  HEADER DELLA SIDEBAR
  - Stili per l'intestazione del menu laterale.
*/
.sidebar-header {
    display: flex; /* Usa Flexbox per allineare gli elementi interni (il titolo e lo spaziatore). */
    align-items: center; /* Allinea verticalmente gli elementi al centro. */
    margin-bottom: 15px;
    margin-top: 5px;
}

/* Spaziatore vuoto per allineare il titolo con i contenuti sottostanti. */
.sidebar-spacer {
    width: 30px; /* Larghezza fissa per corrispondere allo spazio del pulsante di apertura/chiusura. */
    height: 28px;
    flex-shrink: 0; /* Impedisce che si rimpicciolisca se lo spazio è poco. */
}

.sidebar-header h2 {
    margin: 0;
    color: #fff; /* Testo bianco per il titolo del menu. */
    font-size: 16px;
    font-weight: normal; /* Font più leggero del normale. */
    text-align: center;
    transition: opacity 0.2s ease; /* Transizione fluida per l'opacità. */
    white-space: nowrap; /* Impedisce al testo di andare a capo. */
    overflow: hidden; /* Nasconde il testo se esce dal contenitore. */
}

/*
  ELEMENTO MAIN
  - Contenitore per il contenuto principale (il Launchpad).
*/
main {
    width: 100%;
    display: flex;
    justify-content: center; /* Centra il contenuto (il Launchpad) orizzontalmente. */
    align-items: center; /* Centra il contenuto verticalmente. */
}

/*
  LAYOUT PRINCIPALE
  - Utilizza CSS Grid per definire la struttura a due colonne: sidebar e contenuto principale.
  - `grid-template-columns: 0 1fr;` definisce due colonne: la prima (sidebar) ha larghezza 0,
    la seconda (body) occupa tutto lo spazio rimanente (`1fr`).
  - La transizione su `grid-template-columns` crea l'animazione di apertura/chiusura della sidebar.
*/
.layout {
    width: 100%;
    height: 100vh; /* Occupa l'intera altezza della finestra. */
    display: grid;
    grid-template-columns: 0 1fr;
    gap: 8px; /* Spazio tra la sidebar e il contenuto. */
    transition: grid-template-columns .3s ease-in-out; /* Animazione fluida per la larghezza delle colonne. */
    position: relative;
}

/*
  STILI PER LO SFONDO VIDEO
  - Posiziona un video a schermo intero dietro a tutto il resto del contenuto.
  - `object-fit: cover;` assicura che il video copra l'intera area senza distorcersi.
  - `z-index: -2;` lo pone sul livello più basso.
*/
.background-video {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: -2;
}

/*
  OVERLAY DEL VIDEO
  - Un livello che si sovrappone al video per applicare effetti come colore, opacità e sfocatura.
  - PERSONALIZZAZIONE: Modifica `background-color` per cambiare il colore del filtro.
    Il valore `rgba(18, 18, 18, 0.15)` è un nero semitrasparente.
    L'opacità e la sfocatura sono controllate dinamicamente via JavaScript, ma qui puoi impostare i valori di transizione.
*/
.video-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(18, 18, 18, 0.15);
    z-index: -1; /* Si posiziona tra il video e il contenuto. */
    transition: opacity 0.3s ease, backdrop-filter 0.3s ease; /* Transizioni per opacità e sfocatura. */
    opacity: 0; /* Inizialmente invisibile. */
    pointer-events: none; /* Non intercetta i click del mouse. */
    backdrop-filter: blur(0px); /* Nessuna sfocatura iniziale. */
}

/* La classe `.active` viene aggiunta via JS per mostrare l'overlay. */
.video-overlay.active {
    opacity: 1;
}

/*
  CONTROLLI VIDEO (SLIDER)
  - Stili per il contenitore degli slider (opacità, sfocatura, luminosità).
  - L'animazione a comparsa/scomparsa è creata con `max-height` e `padding`.
*/
.video-controls {
    background-color: #252525; /* Sfondo leggermente diverso dal menu per distinguerlo. */
    border-radius: 4px;
    margin-top: 5px;
    padding: 0 15px;
    max-height: 0; /* Inizialmente chiuso (altezza zero). */
    overflow: hidden;
    transition: max-height 0.3s ease-out, padding 0.3s ease-out;
}

/* La classe `.visible` viene aggiunta via JS per mostrare i controlli. */
.video-controls.visible {
    padding: 15px;
    max-height: 500px; /* Altezza sufficiente a contenere tutto. */
    transition: max-height 0.4s ease-in, padding 0.4s ease-in;
}

/*
  GRUPPI DI CONTROLLO (Etichetta + Slider)
*/
.control-group {
    margin-bottom: 12px;
    position: relative;
}

.control-group:last-child {
    margin-bottom: 0;
}

.control-group label {
    display: block;
    font-size: 12px;
    color: #ccc;
    margin-bottom: 5px;
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* Aggiunge ... se il testo è troppo lungo */
    max-width: 100%; /* Limita la larghezza massima */
    box-sizing: border-box; /* Include il padding nel calcolo della larghezza */
}

.input-group {
    display: flex;
    align-items: center;
    gap: 4px;
    margin-bottom: 4px;
    flex-wrap: nowrap;
    justify-content: space-between;
}

/*
  STILI PER GLI SLIDER
  - PERSONALIZZAZIONE: Il colore principale dello slider è dato dal `background` del `thumb` (il pallino).
    Cambia `#00ff88` per modificare il colore del pallino dello slider.
    Cambia il `background` di `input[type="range"]` per il colore della barra.
*/
.control-group input[type="range"] {
    width: calc(100% - 85px);
    height: 4px;
    background: #333; /* Colore della barra dello slider. */
    border-radius: 2px;
    outline: none;
    -webkit-appearance: none; /* Rimuove stili di default del browser. */
    appearance: none;
    margin: 0;
    flex-shrink: 1;
    min-width: 50px;
}

/* Input numerico accanto allo slider. */
.manual-input {
    width: 40px;
    height: 16px;
    background: #333;
    border: 1px solid #555;
    border-radius: 2px;
    color: #ccc;
    font-size: 10px;
    text-align: center;
    padding: 0;
    flex-shrink: 0;
}

/* Testo che mostra l'unità di misura (es. 'px', '%'). */
.value-display {
    font-size: 10px;
    color: #888;
    margin-left: 1px;
    white-space: nowrap;
    flex-shrink: 0;
    display: inline;
}

/* Pallino dello slider per browser Webkit (Chrome, Safari). */
.control-group input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 14px;
    height: 14px;
    background: #00ff88; /* Colore del pallino (verde neon). */
    border-radius: 50%; /* Lo rende rotondo. */
    cursor: pointer;
}

/* Pallino dello slider per Firefox. */
.control-group input[type="range"]::-moz-range-thumb {
    width: 14px;
    height: 14px;
    background: #00ff88;
    border-radius: 50%;
    cursor: pointer;
    border: none;
}

/* Stili per i selettori di colore */
.control-group input[type="color"] {
    -webkit-appearance: none;
    appearance: none;
    width: 40px; /* Larghezza simile all'input numerico */
    height: 20px;
    background-color: transparent; /* Rimuove lo sfondo di default */
    border: 1px solid #555;
    border-radius: 4px;
    cursor: pointer;
    padding: 0;
}

.control-group input[type="color"]::-webkit-color-swatch-wrapper {
    padding: 2px; /* Spazio interno per il campione di colore */
    border-radius: 3px;
}

.control-group input[type="color"]::-webkit-color-swatch {
    border: none;
    border-radius: 2px;
}

/* Stili per il menu a tendina (select) */
.control-group select {
    background-color: #333;
    color: #ccc;
    border: 1px solid #555;
    border-radius: 4px;
    padding: 4px 8px;
    font-size: 12px;
    width: 100%; /* Occupa tutta la larghezza disponibile */
    box-sizing: border-box;
}

.control-group select:focus {
    outline: none;
    border-color: #00aaff;
}


/*
  STILI PER IL CONTENUTO PRINCIPALE (BODY)
*/
.body {
    position: relative;
    z-index: 2; /* Si posiziona sopra il visualizzatore e lo sfondo. */
}

/*
  LAYOUT CON SIDEBAR APERTA
  - Quando il `.layout` ha la classe `.sidebar-open`, la prima colonna (sidebar) si espande a 260px.
  - Questo cambiamento attiva la transizione definita in `.layout`.
*/
.layout.sidebar-open {
    grid-template-columns: 260px 1fr;
}

/*
  SIDEBAR
  - Stili per il menu laterale.
  - Inizialmente è nascosta (`opacity: 0`, `visibility: hidden`).
*/
.sidebar {
    grid-column: 1; /* Occupa la prima colonna della griglia. */
    background-color: #2a2a2a;
    padding: 0px 16px 50px 16px; /* Aumentato il padding inferiore da 16px a 50px per accomodare l'indicatore MIDI */
    height: 100%;
    position: relative;
    z-index: 1;
    overflow: hidden;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    box-sizing: border-box; /* Assicura che il padding sia incluso nel calcolo dell'altezza */
}

/* La classe `.sidebar-open` sul layout rende visibile la sidebar. */
.layout.sidebar-open .sidebar {
    opacity: 1;
    visibility: visible;
}

.sidebar-content {
    display: flex;
    flex-direction: column;
    gap: 10px; /* Spazio tra i vari menu (Progetto, Background, etc.). */
}

.menu-item {
    display: flex;
    flex-direction: column;
}

/*
  PULSANTI DEL MENU
  - PERSONALIZZAZIONE: Cambia `background` e `color` per lo stile dei pulsanti.
    Il colore `:hover` definisce l'aspetto al passaggio del mouse.
*/
.menu-toggle {
    background: #2a2a2a;
    color: white;
    border: none;
    padding: 12px 15px;
    border-radius: 4px;
    cursor: pointer;
    text-align: left;
    font-size: 14px;
    transition: background-color 0.2s ease;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* Aggiunge ... se il testo è troppo lungo */
    width: 100%; /* Assicura che il pulsante occupi tutta la larghezza disponibile */
    box-sizing: border-box; /* Include il padding nel calcolo della larghezza */
}

.menu-toggle:hover {
    background: #3a3a3a; /* Colore più chiaro al passaggio del mouse. */
}

.menu-toggle.active {
    background: #3a3a3a;
    border-left: 3px solid #00aaff;
}

/*
  MENU A TENDINA (DROPDOWN)
  - Contenitori per le opzioni di ogni menu.
  - L'animazione è gestita tramite `max-height`, passando da 0 a un valore sufficiente a mostrare il contenuto.
*/
.menu-dropdown {
    max-height: 0; /* Inizialmente chiuso. */
    overflow: hidden;
    transition: max-height 0.3s ease;
    background: #252525;
    border-radius: 4px;
    margin-top: 5px;
    max-width: 100%; /* Limita la larghezza massima al contenitore genitore */
    box-sizing: border-box; /* Include il padding nel calcolo della larghezza */
}

/* La classe `.open` viene aggiunta via JS per aprire il dropdown. */
.menu-dropdown.open {
    max-height: 200px; /* Altezza massima. Aumentala se il contenuto non è visibile. */
    overflow-y: auto; /* Mostra una scrollbar se il contenuto supera l'altezza massima. */
}

/*
  PULSANTI DENTRO I MENU A TENDINA
  - PERSONALIZZAZIONE: Cambia `background` e `color` di `button:hover` e `button.selected`
    per modificare l'aspetto dell'opzione selezionata o al passaggio del mouse.
*/
.menu-dropdown button {
    display: block;
    width: 100%;
    background: none;
    color: #ccc;
    border: none;
    padding: 10px 15px;
    text-align: left;
    cursor: pointer;
    font-size: 13px;
    transition: background-color 0.2s ease, color 0.2s ease;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis; /* Aggiunge ... se il testo è troppo lungo */
    box-sizing: border-box; /* Include il padding nel calcolo della larghezza */
}

.menu-dropdown button:hover,
.menu-dropdown button.selected {
    background: #333;
    color: white;
}

/*
  SCROLLBAR PERSONALIZZATA
  - Stili per la barra di scorrimento all'interno dei menu a tendina.
  - PERSONALIZZAZIONE: Cambia i colori di `background` per `-track` e `-thumb` per adattarla al tuo tema.
*/
.menu-dropdown::-webkit-scrollbar {
    width: 8px;
}

.menu-dropdown::-webkit-scrollbar-track {
    background: #2a2a2a;
    border-radius: 10px;
}

.menu-dropdown::-webkit-scrollbar-thumb {
    background: #00aaff; /* Colore della barra di scorrimento (blu). */
    border-radius: 10px;
}

.menu-dropdown::-webkit-scrollbar-thumb:hover {
    background: #0088cc; /* Colore al passaggio del mouse. */
}

/*
  PULSANTE APRI/CHIUDI SIDEBAR (Hamburger menu)
  - PERSONALIZZAZIONE: Cambia `background-color` per modificare il colore del pulsante.
*/
#openSidebar {
    position: fixed;
    top: 0;
    left: 0;
    background-color: #00aaff; /* Colore blu. */
    border: none;
    color: white;
    padding: 10px 10px;
    border-radius: 3px;
    cursor: pointer;
    z-index: 3; /* Si posiziona sopra quasi tutto. */
    transition: background-color 0.3s ease;
    font-size: 18px;
    line-height: 1;
    margin: 0;
}

#openSidebar:hover {
    background-color: #0088cc;
}

/* Icona dentro il pulsante (le tre linee). */
#openSidebar .icon {
    display: inline-block;
    transition: transform 0.3s ease; /* Anima la rotazione. */
    font-size: 20px;
    line-height: 1;
    margin: 0;
    padding: 0;
}

/* Quando la sidebar è aperta, l'icona ruota per diventare una 'X' (o simile). */
.layout.sidebar-open #openSidebar .icon {
    transform: rotate(90deg);
}

/*
  CONTENITORE DEL CORPO PRINCIPALE
  - Occupa la seconda colonna della griglia.
*/
.body {
    grid-column: 2;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    position: relative;
}

/*
  STILI PER IL VISUALIZZATORE AUDIO (CANVAS)
  - Posiziona i due canvas (superiore e inferiore) ai bordi della finestra.
  - `pointer-events: none;` permette di cliccare attraverso il canvas sugli elementi sottostanti.
  - La transizione su `left` e `width` permette al canvas di adattarsi fluidamente all'apertura/chiusura della sidebar.
*/
.visualizer-canvas {
    position: fixed;
    left: 0;
    width: 100%;
    height: 25%; /* Altezza del visualizzatore. Puoi cambiarla per renderlo più grande o più piccolo. */
    z-index: 1; /* Si posiziona sotto il contenuto principale ma sopra lo sfondo. */
    pointer-events: none;
    transition: left 0.3s ease-in-out, width 0.3s ease-in-out;
}
#visualizer-canvas-top { top: 0; }
#visualizer-canvas-bottom { bottom: 0; }

/* Adatta la posizione e la larghezza del visualizzatore quando la sidebar è aperta. */
.layout.sidebar-open .visualizer-canvas {
    left: 260px; /* Sposta l'inizio del canvas a destra della sidebar. */
    width: calc(100% - 260px); /* Riduce la larghezza per non sovrapporsi alla sidebar. */
}

/*
  ANIMAZIONE DI ERRORE
  - Un'animazione 'shake' (scuotimento) usata per dare un feedback visivo, per esempio
    quando si cerca di usare una funzione non disponibile (come il MIDI).
*/
@keyframes shake {
  10%, 90% { transform: translate3d(-1px, 0, 0); }
  20%, 80% { transform: translate3d(2px, 0, 0); }
  30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
  40%, 60% { transform: translate3d(4px, 0, 0); }
}

.error-shake {
  animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
}

.midi-status-fixed {
  position: absolute;
  bottom: 10px;
  left: 16px; /* Allineato con il padding della sidebar */
  right: 16px; /* Limita la larghezza massima */
  display: flex;
  align-items: center;
  color: #fff;
  font-size: 0.85em; /* Leggermente ridotto per adattarsi meglio */
  background-color: rgba(0, 0, 0, 0.3); /* Sfondo semi-trasparente per migliorare la leggibilità */
  padding: 8px 12px;
  border-radius: 4px;
  box-sizing: border-box; /* Include il padding nel calcolo della larghezza */
}

.midi-status-dot {
  width: 8px; /* Leggermente ridotto */
  height: 8px;
  border-radius: 50%;
  margin-right: 8px;
  flex-shrink: 0; /* Non si riduce mai */
}

#midi-status-text {
  overflow: hidden;
  text-overflow: ellipsis; /* Aggiunge ... se il testo è troppo lungo */
  white-space: nowrap; /* Impedisce al testo di andare a capo */
  flex-grow: 1; /* Occupa lo spazio rimanente */
  min-width: 0; /* Permette al flex item di restringersi */
}
