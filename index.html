<!--
  This file is the main entry point of the Launchpad PWA application.
  It defines the basic structure of the HTML page, loads CSS styles,
  necessary JavaScript files, and sets up user interface elements.
-->
<!DOCTYPE html>
<html lang="it">

<head>
  <!--
      The <head> section contains important metadata for the browser and search engines,
      as well as links to CSS and JavaScript files.
    -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Launchpad PWA</title>

  <!--
      PWA MANIFEST (Progressive Web App)
      The manifest.json file provides information about the application (such as name, icons, colors)
      and allows it to be installed on desktop and mobile devices as if it were a native app.
      To customize the appearance of the installed app (e.g., name, icon), modify this file.
    -->
  <link rel="manifest" href="manifest.json">

  <!--
      ICONS
      These lines define the application icons for different platforms and sizes.
      - favicon.ico: Traditional icon for browsers.
      - favicon-32x32.png / favicon-16x16.png: Specific sizes for browser tabs.
      - apple-touch-icon.png: Icon for Apple devices when the app is added to the home screen.
      You can replace these files in 'assets/icons/' with your custom icons.
    -->
  <link rel="icon" href="assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/icons/favicon-16x16.png">
  <link rel="apple-touch-icon" href="assets/icons/apple-touch-icon.png">

  <!--
      STYLESHEETS (CSS)
      - style.css: Contains general styles for the layout, sidebar, and other interface elements.
                   Modify this file to change the general appearance of the app (colors, fonts, etc.).
      - launchpad.css: Contains specific styles for the Launchpad grid and its pads.
                       Modify this file to customize the Launchpad appearance (pad colors, animations, etc.).
    -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/launchpad.css">

  <!--
      JAVASCRIPT SCRIPTS
      - app.js: The main script that handles application logic.
                It imports and coordinates other JavaScript modules.
      - type="module": Enables ES6 module functionality (import/export).
      - defer: Ensures the script runs only after the entire HTML document has loaded.
    -->
  <script src="js/interaction.js" type="module" defer></script>
  <script src="js/ui.js" type="module" defer></script>
  <script src="js/video.js" type="module" defer></script>
  <script src="js/visualizer-controls.js" type="module" defer></script>
  <script src="js/project.js" type="module" defer></script>
  <script src="js/app.js" type="module" defer></script>
</head>

<body>

  <!--
  MAIN LAYOUT
  The div with class "layout" is the main container that organizes the sidebar and the page body.
  The entire structure is based on CSS Grid for a flexible layout.
-->
  <div class="layout">
    <!--
      BACKGROUND ELEMENTS AND VISUALIZER
      - video-overlay: A semi-transparent layer overlaying the background video to improve readability.
                       The opacity is controlled from the menu.
      - visualizer-canvas: Two <canvas> elements used to draw the audio visualizer (one at the top, one at the bottom).
                           Their visibility and behavior are managed by 'js/visualizer.js'.
    -->
    <div class="video-overlay"></div>
    <canvas id="visualizer-canvas-top" class="visualizer-canvas"></canvas>
    <canvas id="visualizer-canvas-bottom" class="visualizer-canvas"></canvas>

    <!--
      SIDEBAR (SIDE MENU)
      Contains menus to select projects, change background, control the visualizer, and customize the Launchpad.
      Sidebar visibility is managed via JavaScript (function toggleSidebar).
    -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-spacer"></div>
        <h2 data-i18n="sidebar.title">Menu</h2>
      </div>
      <div class="sidebar-content">
        <div class="menu-item">
          <button class="menu-toggle" onclick="toggleMenu('language-menu')"
            data-i18n="menu.language.toggle">Lingua</button>
          <div class="menu-dropdown" id="language-menu">
            <div class="control-group" style="padding: 15px 15px 5px 15px;">
              <label for="language-select" data-i18n="menu.language.label">Seleziona lingua</label>
              <div class="input-group">
                <select id="language-select">
                  <option value="it">Italiano</option>
                  <option value="en">English</option>
                  <option value="es">Español</option>
                  <option value="de">Deutsch</option>
                  <option value="fr">Français</option>
                </select>
              </div>
            </div>
          </div>
        </div>
        <!--
          PROJECT SELECTION MENU
          - The content of 'project-menu' is populated dynamically
            using static data loaded in JavaScript.
        -->
        <div class="menu-item">
          <button class="menu-toggle" onclick="toggleMenu('project-menu')" data-i18n="menu.project.toggle">Seleziona
            progetto</button>
          <div class="menu-dropdown" id="project-menu">
            <!-- Project items will be populated dynamically -->
          </div>
        </div>

        <!--
          BACKGROUND MENU
          - Allows selecting a background video.
          - Also contains controls to customize the appearance of the background video.
          - CUSTOMIZATION: To add new videos, place them in the 'assets/videos/' folder.
        -->
        <div class="menu-item">
          <button class="menu-toggle" onclick="toggleMenu('background-menu')"
            data-i18n="menu.background.toggle">Sfondo</button>
          <div class="menu-dropdown" id="background-menu">
            <button class="menu-option selected" data-video="none" onclick="clearBackground()"
              data-i18n="background.none">Nessuno sfondo</button>
            <div class="control-group" style="padding: 15px 15px 5px 15px;">
              <label for="background-file-input" data-i18n="background.upload">Carica file</label>
              <div class="input-group">
                <input type="file" id="background-file-input" class="file-input-hidden" accept="video/*,image/*">
                <button type="button" class="menu-option" id="background-file-trigger"
                  data-i18n="background.upload">Carica file</button>
              </div>
            </div>
            <!--
              VIDEO CONTROLS
              These sliders allow real-time adjustments:
              - Opacity: Controls transparency of the overlay above the video.
              - Blur: Applies a blur filter to the video.
              - Brightness: Adjusts the video brightness.
            -->
            <div class="video-controls">
              <div class="control-group">
                <label for="opacity-slider" data-i18n="background.opacity">Opacità</label>
                <div class="input-group">
                  <input type="range" id="opacity-slider" min="0" max="100" step="1" value="0">
                  <div class="input-with-unit">
                    <input type="number" id="opacity-input" min="0" max="100" step="1" value="0" class="manual-input">
                    <span class="value-display">%</span>
                  </div>
                </div>
              </div>
              <div class="control-group">
                <label for="blur-slider" data-i18n="background.blur">Sfocatura</label>
                <div class="input-group">
                  <input type="range" id="blur-slider" min="0" max="100" step="1" value="0">
                  <div class="input-with-unit">
                    <input type="number" id="blur-input" min="0" max="100" step="1" value="0" class="manual-input">
                    <span class="value-display">%</span>
                  </div>
                </div>
              </div>
              <div class="control-group">
                <label for="brightness-slider" data-i18n="background.brightness">Luminosità</label>
                <div class="input-group">
                  <input type="range" id="brightness-slider" min="0" max="200" step="1" value="100">
                  <div class="input-with-unit">
                    <input type="number" id="brightness-input" min="0" max="200" step="1" value="100"
                      class="manual-input">
                    <span class="value-display">%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Fixed MIDI Status at the bottom of the sidebar -->
          <div class="midi-status-fixed">
            <span id="midi-status-dot" class="midi-status-dot disconnected"></span>
            <span id="midi-status-text" data-i18n="midi.status.disconnected">Launchpad scollegato</span>
          </div>
        </div>

        <!--
          VISUALIZER MENU
          - Controls the behavior of the audio visualizer.
          - The onclick functions call methods of the 'visualizer' object defined in 'js/visualizer.js'.
          - CUSTOMIZATION: Visualizer parameters (e.g., colors, bar type)
            can be modified directly in 'js/visualizer.js'.
        -->
        <div class="menu-item">
          <button class="menu-toggle" onclick="toggleMenu('visualizer-menu')"
            data-i18n="menu.visualizer.toggle">Visualizzatore</button>
          <div class="menu-dropdown" id="visualizer-menu">
            <button class="menu-option selected" data-mode="both" onclick="visualizer.setMode('both')"
              data-i18n="visualizer.mode.both">Entrambi</button>
            <button class="menu-option" data-mode="both-mirror" onclick="visualizer.setMode('both-mirror')"
              data-i18n="visualizer.mode.both-mirror">Entrambi (specchiato)</button>
            <button class="menu-option" data-mode="top" onclick="visualizer.setMode('top')"
              data-i18n="visualizer.mode.top">Superiore</button>
            <button class="menu-option" data-mode="top-mirror" onclick="visualizer.setMode('top-mirror')"
              data-i18n="visualizer.mode.top-mirror">Superiore (specchiato)</button>
            <button class="menu-option" data-mode="bottom" onclick="visualizer.setMode('bottom')"
              data-i18n="visualizer.mode.bottom">Inferiore</button>
            <button class="menu-option" data-mode="bottom-mirror" onclick="visualizer.setMode('bottom-mirror')"
              data-i18n="visualizer.mode.bottom-mirror">Inferiore (specchiato)</button>
            <button class="menu-option" data-mode="off" onclick="visualizer.setMode('off')"
              data-i18n="visualizer.mode.off">Spento</button>

            <div class="control-group" id="symmetric-group">
              <label for="symmetric-checkbox">
                <input type="checkbox" id="symmetric-checkbox">
                <span data-i18n="visualizer.symmetric">Simmetrico</span>
              </label>
              <div class="input-group" id="symmetric-mode" style="display: none; margin-top: 8px;">
                <label for="symmetric-mode-select" data-i18n="visualizer.symmetricMode">Modalità</label>
                <select id="symmetric-mode-select">
                  <option value="normal" data-i18n="visualizer.symmetric.normal">Normale</option>
                  <option value="reverse" data-i18n="visualizer.symmetric.reverse">Inversa</option>
                </select>
              </div>
            </div>

            <!-- Visualizer smoothness control -->
            <div class="control-group" id="smoothing-group">
              <label for="smoothing-slider" data-i18n="visualizer.smoothing">Fluidità</label>
              <div class="input-group">
                <input type="range" id="smoothing-slider" min="0" max="0.95" step="0.05" value="0.8">
                <div class="input-with-unit">
                  <input type="number" id="smoothing-input" min="0" max="0.95" step="0.05" value="0.8"
                    class="manual-input">
                </div>
              </div>
            </div>

            <!-- Color and transparency controls -->
            <div class="control-group" id="color1-group">
              <label for="color1-picker" data-i18n="visualizer.color1">Colore 1</label>
              <div class="input-group">
                <input type="color" id="color1-picker" value="#00aaff">
              </div>
            </div>
            <div class="control-group" id="enable-gradient-group">
              <label for="enable-color2-checkbox">
                <input type="checkbox" id="enable-color2-checkbox">
                <span data-i18n="visualizer.gradient.enable">Abilita Gradiente</span>
              </label>
            </div>
            <div id="gradient-controls" style="display: none;">
              <div class="control-group">
                <label for="color2-picker" data-i18n="visualizer.color2">Colore 2</label>
                <div class="input-group">
                  <input type="color" id="color2-picker" value="#00aaff">
                </div>
              </div>
              <div class="control-group">
                <label for="gradient-direction" data-i18n="visualizer.gradient.direction">Direzione Gradiente</label>
                <select id="gradient-direction">
                  <option value="vertical" data-i18n="visualizer.gradient.vertical">Verticale</option>
                  <option value="horizontal" data-i18n="visualizer.gradient.horizontal">Orizzontale</option>
                  <option value="vertical-reverse" data-i18n="visualizer.gradient.verticalReverse">Verticale (inverso)
                  </option>
                  <option value="horizontal-reverse" data-i18n="visualizer.gradient.horizontalReverse">Orizzontale
                    (inverso)</option>
                </select>
              </div>
            </div>
            <div class="control-group" id="alpha-group">
              <label for="alpha-slider" data-i18n="visualizer.alpha">Trasparenza</label>
              <div class="input-group">
                <input type="range" id="alpha-slider" min="0" max="1" step="0.05" value="0.6">
                <div class="input-with-unit">
                  <input type="number" id="alpha-input" min="0" max="1" step="0.05" value="0.6" class="manual-input">
                </div>
              </div>
            </div>

            <!-- Bass Pulse control group -->
            <div class="control-group" id="bass-pulse-group">
              <label for="bass-pulse-toggle">
                <input type="checkbox" id="bass-pulse-toggle">
                <span data-i18n="visualizer.bassPulse.enable">Effetto Pulsante Bassi</span>
              </label>
              <div id="bass-threshold-controls" style="display: none; margin-top: 8px;">
                <label for="bass-threshold-slider" data-i18n="visualizer.bassPulse.threshold">Soglia Bassi</label>
                <div class="input-group">
                  <input type="range" id="bass-threshold-slider" min="0" max="255" step="1" value="150">
                  <div class="input-with-unit">
                    <input type="number" id="bass-threshold-input" min="0" max="255" step="1" value="150"
                      class="manual-input">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!--
          LAUNCHPAD CUSTOMIZATION MENU
          - Contains options to change the appearance of the Launchpad.
          - 'toggle-stickers': Shows/hides decorative stickers on the Launchpad.
          - CUSTOMIZATION: To add new Launchpad backgrounds, place images
            in the 'assets/images/launchpad covers/' folder.
        -->
        <div class="menu-item">
          <button class="menu-toggle" onclick="toggleMenu('personalize-launchpad-menu')"
            data-i18n="menu.launchpad.toggle">Personalize Launchpad</button>
          <div class="menu-dropdown" id="personalize-launchpad-menu">
            <div class="control-group">
              <label for="toggle-stickers">
                <input type="checkbox" id="toggle-stickers" onchange="toggleLaunchpadStickers(this.checked)">
                <span data-i18n="launchpad.stickers.show">Mostra Adesivi</span>
              </label>
            </div>
            <div class="control-group">
              <label for="rotation-slider" data-i18n="launchpad.rotation">Rotazione Launchpad</label>
              <div class="input-group">
                <input type="range" id="rotation-slider" min="0" max="360" step="1" value="0">
                <div class="input-with-unit">
                  <input type="number" id="rotation-input" min="0" max="360" step="1" value="0" class="manual-input">
                  <span class="value-display">°</span>
                </div>
              </div>
            </div>
            <div class="control-group">
              <label for="size-slider" data-i18n="launchpad.size">Dimensione Launchpad</label>
              <div class="input-group">
                <input type="range" id="size-slider" min="50" max="140" step="1" value="100">
                <div class="input-with-unit">
                  <input type="number" id="size-input" min="50" max="140" step="1" value="100" class="manual-input">
                  <span class="value-display">%</span>
                </div>
              </div>
            </div>
            <div class="control-group">
              <label for="logo-file-input" data-i18n="launchpad.icon.label">Icona in alto a destra</label>
              <input type="file" id="logo-file-input" class="file-input-hidden" accept="video/*,image/*">
              <button type="button" class="menu-option" id="logo-file-trigger" data-i18n="launchpad.icon.upload">Carica
                icona/video</button>
              <button type="button" class="menu-option" onclick="resetTopRightIcon()"
                data-i18n="launchpad.icon.reset">Ripristina icona</button>
            </div>
            <div class="control-group">
              <span class="section-title" data-i18n="launchpad.skins.title">Sfondi Launchpad</span>
            </div>
            <button class="menu-option selected" data-skin="none" onclick="setLaunchpadBackground(null)"
              data-i18n="launchpad.default">Default</button>
          </div>
        </div>


      </div>
    </div>

    <!--
      MAIN BODY
      Contains the button to open the sidebar and the Launchpad itself.
    -->
    <div class="body">
      <button id="openSidebar" onclick="toggleSidebar()"><span class="icon">☰</span></button>
      <main>
        <!--
          LAUNCHPAD
          The heart of the application: a grid of buttons that play sounds.
        -->
        <div class="Launchpad" id="Launchpad">
          <!--
            AUDIO UNLOCK OVERLAY
            Many modern browsers block automatic audio playback.
            This overlay requires user interaction (a click) to unlock the AudioContext,
            ensuring that sounds can be played.
          -->
          <div id="audio-unlock-overlay" class="launchpad-overlay">
            <p data-i18n="overlay.clickToStart">Clicca per avviare</p>
          </div>

          <!--
            DECORATIVE ELEMENTS OF THE LAUNCHPAD
            These elements (triangles, texts, logo) are purely aesthetic.
            Their visibility can be controlled via CSS or JavaScript (e.g., 'toggleLaunchpadStickers').
            - CUSTOMIZATION: You can change images, texts, or styles by
              editing CSS in 'launchpad.css' or replacing images in 'assets/icons/'.
          -->
          <div class="grid-item-triangle"><img src="assets/icons/triangle.png" class="triangolo"></div>
          <div class="grid-item-triangle"><img style="transform: rotate(180deg);" src="assets/icons/triangle.png"
              class="triangolo"></div>
          <div class="grid-item-triangle"><img style="transform: rotate(270deg);" src="assets/icons/triangle.png"
              class="triangolo"></div>
          <div class="grid-item-triangle"><img style="transform: rotate(90deg);" src="assets/icons/triangle.png"
              class="triangolo"></div>
          <div class="testo_su_launchpad">Session</div>
          <div class="testo_su_launchpad">User 1</div>
          <div class="testo_su_launchpad">User 2</div>
          <div class="testo_su_launchpad">Mixer</div>
          <div id="image-container"><img src="assets/icons/Logo.png" alt="immagine" class="square-image"></div>

          <!--
            TOP CONTROL BUTTONS (Row 'a')
            These buttons are currently empty with no associated functions.
            They may be used in the future for global functions.
          -->
          <div id="a1" class="grid-item-menu"></div>
          <div id="a2" class="grid-item-menu"></div>
          <div id="a3" class="grid-item-menu"></div>
          <div id="a4" class="grid-item-menu"></div>
          <div id="a5" class="grid-item-menu"></div>
          <div id="a6" class="grid-item-menu"></div>
          <div id="a7" class="grid-item-menu"></div>
          <div id="a8" class="grid-item-menu"></div>

          <!--
            8x8 PAD GRID (Rows 'b' to 'i')
            Each pad has:
            - A unique ID (e.g., "b1", "c2", ...).
            - The "grid-item" class for styling.
            - Interaction is handled via event delegation in 'js/interaction.js'.
              - The 'data-index' attribute is assigned dynamically to identify the pad (0-63).
            The playback logic is in 'js/audio.js'.
            The assignment of sounds to pads is defined in the JSON project files (e.g., 'projects/Virtual Riot - Idols.json').
          -->
          <div id="b1" class="grid-item"></div>
          <div id="b2" class="grid-item"></div>
          <!-- ... other pads from b3 to b8 ... -->
          <div id="b3" class="grid-item"></div>
          <div id="b4" class="grid-item"></div>
          <div id="b5" class="grid-item"></div>
          <div id="b6" class="grid-item"></div>
          <div id="b7" class="grid-item"></div>
          <div id="b8" class="grid-item"></div>

          <!--
            SIDE CONTROL BUTTONS (column 'm')
            These buttons (m1-m8) change the sound "page" or "set".
            - Interaction is handled via event delegation in 'js/interaction.js'.
              - The 'data-page' attribute is assigned dynamically to identify the page (0-7).
            Logic is handled in 'js/app.js' and 'js/audio.js'.
            The texts next to these buttons (Volume, Pan, etc.) are purely decorative.
          -->
          <div id="m1" class="grid-item-menu"></div>
          <div class="testo_su_launchpad">Volume</div>

          <div id="c1" class="grid-item"></div>
          <div id="c2" class="grid-item"></div>
          <div id="c3" class="grid-item"></div>
          <div id="c4" class="grid-item"></div>
          <div id="c5" class="grid-item"></div>
          <div id="c6" class="grid-item"></div>
          <div id="c7" class="grid-item"></div>
          <div id="c8" class="grid-item"></div>

          <div id="m2" class="grid-item-menu"></div>
          <div class="testo_su_launchpad">Pan</div>

          <div id="d1" class="grid-item"></div>
          <div id="d2" class="grid-item"></div>
          <div id="d3" class="grid-item"></div>
          <div id="d4" class="grid-item"></div>
          <div id="d5" class="grid-item"></div>
          <div id="d6" class="grid-item"></div>
          <div id="d7" class="grid-item"></div>
          <div id="d8" class="grid-item"></div>

          <div id="m3" class="grid-item-menu"></div>
          <div class="testo_su_launchpad">Send A</div>

          <div id="e1" class="grid-item"></div>
          <div id="e2" class="grid-item"></div>
          <div id="e3" class="grid-item"></div>
          <div id="e4" class="grid-item"></div>
          <div id="e5" class="grid-item"></div>
          <div id="e6" class="grid-item"></div>
          <div id="e7" class="grid-item"></div>
          <div id="e8" class="grid-item"></div>

          <div id="m4" class="grid-item-menu"></div>
          <div class="testo_su_launchpad">Send B</div>

          <div id="f1" class="grid-item"></div>
          <div id="f2" class="grid-item"></div>
          <div id="f3" class="grid-item"></div>
          <div id="f4" class="grid-item"></div>
          <div id="f5" class="grid-item"></div>
          <div id="f6" class="grid-item"></div>
          <div id="f7" class="grid-item"></div>
          <div id="f8" class="grid-item"></div>

          <div id="m5" class="grid-item-menu"></div>
          <div class="testo_su_launchpad">Stop</div>

          <div id="g1" class="grid-item"></div>
          <div id="g2" class="grid-item"></div>
          <div id="g3" class="grid-item"></div>
          <div id="g4" class="grid-item"></div>
          <div id="g5" class="grid-item"></div>
          <div id="g6" class="grid-item"></div>
          <div id="g7" class="grid-item"></div>
          <div id="g8" class="grid-item"></div>

          <div id="m6" class="grid-item-menu"></div>
          <div class="testo_su_launchpad">Mute</div>

          <div id="h1" class="grid-item"></div>
          <div id="h2" class="grid-item"></div>
          <div id="h3" class="grid-item"></div>
          <div id="h4" class="grid-item"></div>
          <div id="h5" class="grid-item"></div>
          <div id="h6" class="grid-item"></div>
          <div id="h7" class="grid-item"></div>
          <div id="h8" class="grid-item"></div>

          <div id="m7" class="grid-item-menu"></div>
          <div class="testo_su_launchpad">Solo</div>

          <div id="i1" class="grid-item"></div>
          <div id="i2" class="grid-item"></div>
          <div id="i3" class="grid-item"></div>
          <div id="i4" class="grid-item"></div>
          <div id="i5" class="grid-item"></div>
          <div id="i6" class="grid-item"></div>
          <div id="i7" class="grid-item"></div>
          <div id="i8" class="grid-item"></div>
          
          <div id="m8" class="grid-item-menu"></div>
          <div class="testo_su_launchpad">Record</div>
        </div>
        <div id="notification-container"></div>
      </main>
    </div>
</body>

</html>